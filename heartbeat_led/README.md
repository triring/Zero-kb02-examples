# Heatbeat LED

## このプログラムについて
Raspberry pi のアクセスランプ（緑）は、ACT LEDは設定により外部LEDとしての機能を割り当てることができる。  
デフォルトでは、ACT LEDはSDへのアクセスで点滅するように設定されているが、これをheartbeatモードに設定すると一定間隔で「短い点滅が2回、その後に少し長い休止」の点滅し続けるようになる。  
この点滅周期は、システムの負荷（ロードアベレージ）と連動しており、以下のように変動する。

* 低負荷: 点滅の間隔はゆっくりになる。
* 高負荷: 点滅の間隔が速くなり、最大で毎分180回程度の速い点滅になる。

今回は、これを模倣し、心拍を、フルカラーLEDで表現してみた。
英語の医学的・科学的な文脈では、心音をLub-dubと表現する。
これは、心臓の弁が閉じる音を正確に表したもので、「lub」が心室の収縮（第一心音）、「dub」が心室の弛緩（第二心音）に対応している。
今回は、以下の配色でLub-dubと表現した。
* 赤色->lub:心室の収縮(第一心音)
* 青色->dub:心室の弛緩(第二心音)

### コンパイル方法  

必要に応じて、以下のパッケージの導入して下さい。  

```bash
> go mod tidy
> go get github.com/tinygo-org/pio/rp2-pio
> go get github.com/tinygo-org/pio/rp2-pio/piolib
``

ソースコードは、[main.go](main.go) です。  
このソースコードのあるディレクトリに移動して、以下のコマンドを実行して下さい。コンパイルが完了すると、生成した実行用バイナリがマイコンボードに転送されます。  

```bash
> tinygo flash --target waveshare-rp2040-zero --size short -monitor .
```

また、実行用バイナリを転送できない場合は、以下のコマンドで、実行用バイナリを作成し、手作業で、実行用バイナリをzero-kb02に転送して下さい。  

```bash
> tinygo build -o heartbeat_led.uf2 -target=waveshare-rp2040-zero -size short .
```

### 使い方

1. いろいろと前書きをしましたが、単なるL地下です。起動して、LEDの点滅を眺めて下さい。
